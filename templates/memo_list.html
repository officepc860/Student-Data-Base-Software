<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Memo List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light p-4">
    <div class="container">


<form method="GET" action="{{ url_for('memo_list') }}" class="row g-3 mb-5">
        <div class="mb-4">
		<a href="{{ url_for('payment') }}" class="btn btn-outline-secondary"> ‚ÆúBack</a>

		<a href="{{ url_for('export_memo_receipt_pdf', memo_no=request.args.get('memo_no')) }}"
   		class="btn btn-outline-danger" target="_blank">
   		üìÑ Export PDF
		</a>

		<a href="{{ url_for('download_memo_list_excel', memo_no=request.args.get('memo_no')) }}"
   		class="btn btn-outline-success">
   		‚ùé Export Excel
		</a>

                <a href="{{ url_for('memo_list') }}" class="btn btn-outline-primary ms-2"> üóò Refresh</a>
	</div>
</form>

        <h3 class="mb-3">üìù Memo List</h3>

        <form method="GET" action="{{ url_for('memo_list') }}" class="row g-3 mb-4">
            <div class="col-md-3">
                <input type="text" name="memo_no" placeholder="Search Memo No" class="form-control" value="{{ request.args.get('memo_no', '') }}">
            </div>
            <div class="col-md-3">
                <input type="text" name="roll" placeholder="Search Roll" class="form-control" value="{{ request.args.get('roll', '') }}">
            </div>
            <div class="col-md-3">
                <input type="text" name="name" placeholder="Search Name" class="form-control" value="{{ request.args.get('name', '') }}">
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-primary w-100">üîç Search</button>
            </div>
        </form>

        {% if memos %}
        <div class="table-responsive">
            <table class="table table-bordered table-hover table-striped align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>Date</th>
                        <th>Memo No</th>
                        <th>Receipt No</th>
                        <th>Roll</th>
                        <th>Name</th>
                        <th>Course</th>
                        <th>Amount</th>
                        <th>Action</th>  <!-- ‚úÖ Edit column -->
                    </tr>
                </thead>
                <tbody>
                    {% for memo in memos %}
                    <tr>
                        <td>{{ memo.date }}</td>
                        <td>{{ memo.memo_no }}</td>
                        <td>{{ memo.receipt_no }}</td>
                        <td>{{ memo.roll }}</td>
                        <td>{{ memo.name }}</td>
                        <td>{{ memo.course }}</td>
                        <td>{{ memo.amount | int }}</td>

<td>
    <!-- Edit Button -->
    <a href="{{ url_for('edit_memo_receipt', memo_no=memo.memo_no, receipt_no=memo.receipt_no) }}"
       class="btn btn-sm btn-warning">
       ‚úèÔ∏è Edit
    </a>

    <!-- Delete Form Button -->
    <form action="{{ url_for('delete_memo_receipt', memo_no=memo.memo_no, receipt_no=memo.receipt_no) }}"
          method="POST"
          onsubmit="return confirm('Are you sure you want to delete this memo receipt?');"
          style="display:inline-block;">
        <button type="submit" class="btn btn-sm btn-danger">üóëÔ∏è Delete</button>
    </form>
</td>

                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
            <div class="alert alert-info">No memos found.</div>
        {% endif %}

        <!-- Pagination -->
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center">
            <li class="page-item {% if page <= 1 %}disabled{% endif %}">
              <a class="page-link" href="{{ url_for('memo_list', memo_no=search_memo_no, roll=search_roll, name=search_name, page=page-1) }}">Previous</a>
            </li>
            {% for p in range(1, total_pages + 1) %}
              <li class="page-item {% if p == page %}active{% endif %}">
                <a class="page-link" href="{{ url_for('memo_list', memo_no=search_memo_no, roll=search_roll, name=search_name, page=p) }}">{{ p }}</a>
              </li>
            {% endfor %}
            <li class="page-item {% if page >= total_pages %}disabled{% endif %}">
              <a class="page-link" href="{{ url_for('memo_list', memo_no=search_memo_no, roll=search_roll, name=search_name, page=page+1) }}">Next</a>
            </li>
          </ul>
        </nav>
    </div>
</body>
</html>
